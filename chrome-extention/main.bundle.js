(()=>{"use strict";var e={936:(e,t,n)=>{n.d(t,{n:()=>s});const s={controlCcButton:"#ow3 > div.T4LgNb > div > div:nth-child(13) > div.crqnQb > div.UnvNgf.Sdwpn.P9KVBf.IYIJAc.BIBiNe > div.Tmb7Fd > div > div.juFBl",ccMainArea:".a4cQT",ccArea:"#ow3 > div.T4LgNb > div > div:nth-child(13) > div.crqnQb > div.a4cQT > div:nth-child(1) > div:nth-child(1)",usersArea:"#ow3 > div.T4LgNb > div > div:nth-child(13) > div.crqnQb > div:nth-child(2) > div.axUSnc.P9KVBf"}}},t={};function n(s){var l=t[s];if(void 0!==l)return l.exports;var i=t[s]={exports:{}};return e[s](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=n(936);const t=(e,t)=>{var n=t/1e3;e.style.transition="opacity "+n+"s ease",e.style.opacity="0",setTimeout((function(){var t;null===(t=e.parentNode)||void 0===t||t.removeChild(e)}),t)},s="user-cc-class-name";class l{constructor(){this.displayUserCcList=[],this.cclimitSecond=10,this.intervalId=0}getElement(){return document.querySelector(e.n.usersArea)}findUserAreaElement(e){const t=this.getElement();if(t)return Array.from(t.children).find((t=>{var n;const s=t.querySelector("[data-self-name]");return!!s&&!!(null===(n=s.textContent)||void 0===n?void 0:n.startsWith(e))}))}findUserVideoElement(e){const t=this.findUserAreaElement(e);if(!t)return;const n=t.querySelectorAll("video");let s=null;return n.length>=2?n.forEach((e=>{"none"!=e.style.display&&(s=e)})):s=n[0],null!==s?s:void 0}findUserCcElement(e){const t=this.findUserAreaElement(e);if(!t)return;const n=t.querySelector("."+s);return null!==n?n:void 0}appendUserCcElement(e,t){var n;if(!this.findUserAreaElement(e))return;const l=this.findUserVideoElement(e);if(!l)return;const i=document.createElement("div");i.style.color="white",i.style.position="absolute",i.style.bottom="0",i.style.width="100%",i.style.backgroundColor="rgba(0,0,0,0.25)",i.style.margin="0",i.style.zIndex="1000000",i.textContent=t,i.className=s,i.style.opacity="0.5",i.style.fontWeight="700",i.style.textAlign="center",i.style.pointerEvents="none";const r=Math.floor(l.clientWidth/35);i.style.fontSize=r<18?"15px":`${r}px`,i.style.webkitTextStroke=r<27?"1px #000":"2px #000",null===(n=l.parentElement)||void 0===n||n.after(i);const o=this.findUserCcElement(e);o&&this.appendDisplayUserCc(e,o)}updateUserCcElement(e,t){if(!this.findUserAreaElement(e))return;const n=this.findUserVideoElement(e);if(!n)return;const s=this.findUserCcElement(e);if(!s)return;s.textContent=t;const l=Math.floor(n.clientWidth/35);s.style.fontSize=l<18?"15px":`${l}px`,s.style.webkitTextStroke=l<27?"1px #000":"2px #000",this.appendDisplayUserCc(e,s)}deleteUserCcElement(e){const n=this.displayUserCcList.find((t=>t.name===e));n&&t(n.element,2e3)}deleteUserCcElements(){this.displayUserCcList.forEach((e=>{t(e.element,2e3)}))}appendDisplayUserCc(e,t){this.displayUserCcList=this.displayUserCcList.filter((t=>t.name!==e)),this.displayUserCcList.push({name:e,time:(new Date).getTime(),element:t})}runInterval(){this.intervalId=window.setInterval((()=>{this.displayUserCcList.filter((e=>((new Date).getTime()-e.time)/1e3>this.cclimitSecond)).forEach((e=>{t(e.element,2e3)})),this.displayUserCcList=this.displayUserCcList.filter((e=>((new Date).getTime()-e.time)/1e3<this.cclimitSecond))}),3e3)}stopInterval(){clearInterval(this.intervalId)}}class i{constructor(e){this.drawed=!1,this.mouseOver=!1,this.clicked=!1,this.callbackFuncMouseOver=()=>{this.mouseOver=!0,this.changeStyle()},this.callbackFuncMouseLeave=()=>{this.mouseOver=!1,this.changeStyle()},this.callbackFuncClick=()=>{this.clicked=!this.clicked,this.changeStyle(),this.clickCallback(this.clicked)},this.changeStyle=()=>{const e=this.getElement();null!==e&&(e.style.width="40px",e.style.height="40px",e.style.backgroundColor="rgb(60, 64, 67)",e.style.borderRadius="20px",e.style.paddingTop="12px",e.style.paddingBottom="12px",e.style.display="inline-block",e.style.boxSizing="border-box",e.style.filter="brightness(1)",e.innerText="ON",e.style.color="#FFF",this.mouseOver&&(e.style.filter="brightness(1.15)"),this.clicked&&(e.style.color="#000",e.innerText="OFF",e.style.backgroundColor="rgb(138,180,248)"))},this.clickCallback=e}createElement(){const t=document.createElement("div");t.id=i.ELEMENT_ID,t.addEventListener("mouseover",this.callbackFuncMouseOver),t.addEventListener("mouseleave",this.callbackFuncMouseLeave),t.addEventListener("click",this.callbackFuncClick);const n=document.querySelector(e.n.controlCcButton);null!==n&&null!=n.parentNode&&(n.parentNode.insertBefore(t,n.nextElementSibling),this.changeStyle(),this.drawed=!0)}deleteElement(){var e;null===(e=document.getElementById(i.ELEMENT_ID))||void 0===e||e.remove(),this.drawed=!1,this.mouseOver=!1,this.clicked=!1}getElement(){return document.getElementById(i.ELEMENT_ID)}}i.ELEMENT_ID="controlButton";class r{constructor(){this.opacate=!1}opacateElement(){const e=this.getElement();null!==e&&(e.style.opacity="0",this.opacate=!0)}showElement(){const e=this.getElement();null!==e&&(e.style.opacity="1",this.opacate=!1)}getElement(){return document.querySelector(e.n.ccMainArea)}getCcElement(){return document.querySelector(e.n.ccArea)}}const o={childList:!0,subtree:!0};class c{constructor(e){this.observer=null,this.callbackFuncObserver=e}run(){this.observer=new MutationObserver(((e,t)=>{var n,s,l,i;for(const t of e)if("childList"===t.type&&"SPAN"===t.target.nodeName){const e=null===(s=null===(n=t.target.parentNode)||void 0===n?void 0:n.parentNode)||void 0===s?void 0:s.parentNode;if(!e)return;const r=Array.from(e.children);if(3!==r.length)return;this.callbackFuncObserver(null!==(l=r[1].textContent)&&void 0!==l?l:"",r[0].src,null!==(i=r[2].textContent)&&void 0!==i?i:"")}}));const e=(new r).getCcElement();this.observer.observe(e,o)}stop(){var e;null===(e=this.observer)||void 0===e||e.disconnect()}}document.addEventListener("runScript",(e=>{(()=>{console.log("start: application");const e=new l,t=new r;new i((s=>{console.log("click: controlButton"),s?(n.run(),console.log("start: observer"),e.runInterval(),console.log("run: interval"),t.opacateElement()):(n.stop(),console.log("stop: observer"),e.stopInterval(),console.log("stop: interval"),e.deleteUserCcElements(),console.log("delete: cc elements"),t.showElement())})).createElement();const n=new c(((t,n,s)=>{console.log("mutate: cc"),console.log(`name: ${t}`),console.log(`imagePath: ${n}`),console.log(`speach: ${s}`),e.findUserCcElement(t)?e.updateUserCcElement(t,s):e.appendUserCcElement(t,s)}))})()}))})()})();